/* ================= 全局設定 ================= */
body {
    margin: 0; padding: 0; background-color: #000;
    width: 100vw; height: 100vh; overflow: hidden;
    display: flex; justify-content: center; align-items: center;
    font-family: 'Microsoft JhengHei', 'Arial', sans-serif;
}

#game-scale-wrapper { width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; }
#game-container { width: 1386px; height: 640px; position: relative; flex-shrink: 0; background-color: #222; box-shadow: 0 0 50px rgba(0,0,0,0.8); }
.full-bg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-size: 100% 100%; z-index: 0; }
.screen { display: none; width: 100%; height: 100%; position: absolute; top: 0; left: 0; z-index: 10; }
.screen.active { display: block; }
.hover-effect { cursor: pointer; border: none; background: none; padding: 0; transition: transform 0.1s; }
.hover-effect:active { transform: scale(0.95); }
.img-btn img, .icon-btn img, .control-btn img, .popup-btn img { display: block; width: 100%; height: auto; }

/* 1. 大廳 (Lobby) */
.lobby-logo { position: absolute; top: 30px; left: 0; right: 0; margin: 0 auto; width: 594px; z-index: 2; animation: float 3s infinite; }
.lobby-buttons { position: absolute; bottom: 120px; left: 0; right: 0; margin: 0 auto; display: flex; justify-content: center; gap: 40px; z-index: 2; width: fit-content; }
.img-btn { width: 205px; }
.lobby-icons { position: absolute; top: 40px; right: 40px; display: flex; flex-direction: column; gap: 20px; z-index: 10000; pointer-events: auto; }
.icon-btn { width: 80px; }

/* 2. 遊戲 (Game) */
.game-layout-inner { position: relative; width: 100%; height: 100%; z-index: 5; display: flex; justify-content: center; align-items: center; gap: 20px; }

/* 棋盤 - 手動校正 */
.playfield-area { width: 663px; height: 640px; position: relative; flex-shrink: 0; margin-left: 10px; }
.playfield-bg { width: 100%; height: 100%; background: url('images/04_game/playfield.png') no-repeat center; background-size: 100% 100%; padding-top: 91px; padding-left: 122px; box-sizing: border-box; display: flex; justify-content: flex-start; align-items: flex-start; }
.grid-container { display: grid; grid-template-columns: repeat(4, 116px); grid-template-rows: repeat(4, 116px); gap: 8px; transition: transform 0.1s linear; /* 拖動動畫 */ }
.tile { width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; }
.tile-inner { width: 100%; height: 100%; background-size: contain; background-repeat: no-repeat; background-position: center; animation: pop 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); }

/* 面板 - 手動校正 */
.sidebar-area { width: 320px; height: 640px; display: flex; flex-direction: column; align-items: center; justify-content: flex-start; padding-top: 60px; }
.god-container { width: 303px; height: 214px; margin-bottom: 25px; display: flex; justify-content: center; align-items: flex-end; }
#god-character { width: 100%; height: 100%; object-fit: contain; }
.info-group { display: flex; flex-direction: column; gap: 15px; margin-bottom: 30px; }
.stat-box { width: 305px; height: 108px; background-size: 100% 100%; display: flex; justify-content: flex-end; align-items: center; padding-right: 55px; box-sizing: border-box; }
.stat-box span { font-size: 36px; color: #fff; font-weight: 800; font-family: monospace; text-shadow: 2px 2px 2px rgba(0,0,0,0.5); padding-top: 18px; }
.controls-area { display: flex; gap: 20px; align-items: flex-end; margin-left: 10px; }
.control-btn { width: 85px; }

/* 3. 彈窗通用 */
.modal-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: transparent; z-index: 2000; display: flex; justify-content: center; align-items: center; }
.modal-overlay.hidden { display: none; }
.overlay-dimmer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: -1; }
.popup-container { position: relative; display: flex; justify-content: center; align-items: center; }
.popup-bg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; }
.close-btn { position: absolute; top: 15px; right: 15px; width: 50px; height: 50px; }

/* 成就列表 */
.achievement-list { width: 600px; height: 430px; margin-top: 85px; margin-left: auto; margin-right: auto; overflow-y: auto; padding-right: 10px; }
.achievement-list::-webkit-scrollbar { width: 10px; }
.achievement-list::-webkit-scrollbar-track { background: rgba(0,0,0,0.1); border-radius: 5px; }
.achievement-list::-webkit-scrollbar-thumb { background: #4FC3F7; border-radius: 5px; border: none; }
.achievement-list::-webkit-scrollbar-thumb:hover { background: #039BE5; }

.ach-item { width: 566px; height: 92px; margin: 0 auto 10px auto; position: relative; background-image: url('images/02_achievement/ach_bg.png'); background-size: 100% 100%; display: grid; grid-template-columns: 90px 150px 200px 1fr; align-items: center; }
.ach-col-icon { display: flex; justify-content: center; align-items: center; padding-left: 10px; }
.ach-col-icon img { width: 70px; height: 70px; object-fit: contain; transform: none; }
.ach-col-title { font-size: 24px; font-weight: 900; color: #fff; padding-left: 20px; text-align: left; text-shadow: 0px 0px 2px rgba(0,0,0,0.5); }
.ach-col-desc { font-size: 14px; line-height: 1.4; color: #eceff1; text-align: left; padding-left: 80px; }
.ach-col-status { height: 100%; display: flex; justify-content: center; align-items: center; padding-right: 10px; }
.ach-col-status img { width: auto; height: 60%; object-fit: contain; }

/* 4. 演化圖鑑 (書本) */
.book-container { width: 890px; height: 570px; position: relative; display: flex; justify-content: center; align-items: center; }
.book-bg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; }
.page-left { position: absolute; top: 45px; left: 50px; width: 370px; height: 470px; }
.page-right { position: absolute; top: 45px; left: 465px; width: 370px; height: 470px; }
.book-grid-layout { display: grid; grid-template-columns: repeat(3, 1fr); grid-template-rows: repeat(3, 1fr); gap: 5px; height: 100%; align-content: start; }
.book-item { width: 100%; height: 100%; aspect-ratio: 97 / 128; position: relative; display: flex; flex-direction: column; align-items: center; justify-content: flex-start; }
.title-card { background-color: #E0C7A5; border-radius: 6px; display: flex; flex-direction: column; justify-content: center; align-items: center; box-shadow: inset 0 0 10px rgba(0,0,0,0.15); overflow: hidden; }
.title-card img { width: 95%; height: auto; max-width: 100%; max-height: 100%; object-fit: contain; filter: contrast(1.2); }
.item-frame { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; }
.item-creature { position: relative; z-index: 1; width: 85%; height: 65%; object-fit: contain; margin-top: 8px; transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1); }
.book-item:hover .item-creature { transform: translateY(-4px) scale(1.05); }
.item-info { position: absolute; z-index: 1; bottom: 12px; width: 100%; text-align: center; display: flex; justify-content: center; align-items: baseline; gap: 3px; }
.num-text { color: #333; font-size: 18px; font-weight: 900; font-family: 'Arial Black', sans-serif; opacity: 0.5; }
.name-text { color: #5D4037; font-size: 16px; font-weight: 900; letter-spacing: 1px; }
.book-item.locked .item-creature, .book-item.locked .item-info { display: none; }

/* 5. 遊戲結束 */
.modal-content-small { width: 425px; height: 420px; position: relative; display: flex; flex-direction: column; justify-content: flex-end; align-items: center; padding-bottom: 40px; }
.modal-bg-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-size: contain; background-repeat: no-repeat; background-position: center; z-index: -1; }
.modal-btn-group { display: flex; gap: 30px; }
.popup-btn { width: 94px; height: 94px; }

@keyframes pop { 0% {transform: scale(0);} 80% {transform: scale(1.1);} 100% {transform: scale(1);} }
@keyframes float { 0%, 100% {transform: translateY(0);} 50% {transform: translateY(-8px);} }