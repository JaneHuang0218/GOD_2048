/* ================= 全局設定 ================= */
body {
    margin: 0; padding: 0; background-color: #000;
    width: 100vw; height: 100vh; overflow: hidden;
    display: flex; justify-content: center; align-items: center;
    font-family: 'Microsoft JhengHei', 'Arial', sans-serif;
}
#game-scale-wrapper { width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; }
#game-container { width: 1386px; height: 640px; position: relative; flex-shrink: 0; background-color: #222; box-shadow: 0 0 50px rgba(0,0,0,0.8); }
.full-bg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-size: 100% 100%; z-index: 0; }
.screen { display: none; width: 100%; height: 100%; position: absolute; top: 0; left: 0; z-index: 10; }
.screen.active { display: block; }
.hover-effect { cursor: pointer; border: none; background: none; padding: 0; transition: transform 0.1s; }
.hover-effect:active { transform: scale(0.95); }
.img-btn img, .icon-btn img, .control-btn img, .popup-btn img { display: block; width: 100%; height: auto; }

/* 1. 大廳 (Lobby) */
.lobby-logo { position: absolute; top: 30px; left: 0; right: 0; margin: 0 auto; width: 594px; z-index: 2; animation: float 3s infinite; }
.lobby-buttons { position: absolute; bottom: 120px; left: 0; right: 0; margin: 0 auto; display: flex; justify-content: center; gap: 40px; z-index: 2; width: fit-content; }
.img-btn { width: 205px; }

/* ★ 全域按鈕 (右上角) ★ */
.lobby-icons {
    position: absolute; top: 40px; right: 40px;
    display: flex; flex-direction: column; gap: 20px;
    z-index: 10000; pointer-events: auto;
}
.icon-btn { width: 80px; }

/* 2. 遊戲 (Game) */
.game-layout-inner { position: relative; width: 100%; height: 100%; z-index: 5; display: flex; justify-content: center; align-items: center; gap: 40px; }

/* 左側棋盤 */
.playfield-area { width: 663px; height: 640px; position: relative; flex-shrink: 0; margin-left: 10px; display: flex; align-items: center; }
.playfield-bg { width: 100%; height: 100%; background: url('images/04_game/playfield.png') no-repeat center; background-size: 100% 100%; padding-top: 91px; padding-left: 122px; box-sizing: border-box; display: flex; justify-content: flex-start; align-items: flex-start; }
.grid-container { display: grid; grid-template-columns: repeat(4, 116px); grid-template-rows: repeat(4, 116px); gap: 8px; transition: transform 0.1s linear; }
.tile { width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; }
.tile-inner { width: 100%; height: 100%; background-size: contain; background-repeat: no-repeat; background-position: center; animation: pop 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); }

/* 右側面板 */
.sidebar-area { width: 300px; height: 600px; display: flex; flex-direction: column; align-items: center; padding-top: 30px; }
.god-wrapper { position: relative; margin-bottom: 20px; }
.god-container { width: 303px; height: 214px; display: flex; justify-content: center; align-items: flex-end; }
#god-character { width: 100%; height: 100%; object-fit: contain; }

/* 上帝對話框 */
.god-dialog {
    position: absolute; top: -50px; left: 50%; transform: translateX(-50%);
    background: #fff; padding: 8px 15px; border-radius: 15px; border: 2px solid #5D4037;
    font-weight: bold; color: #333; white-space: nowrap; z-index: 20; opacity: 1; transition: opacity 0.5s;
}
.god-dialog.hidden { opacity: 0; }

/* 分數板 */
.info-group { display: flex; flex-direction: column; gap: 15px; margin-bottom: auto; /* 把下方按鈕推到底 */ }
.stat-box { 
    width: 305px; height: 108px; background-size: 100% 100%; 
    display: flex; justify-content: center; /* ★ 文字水平置中 */
    align-items: center; 
    padding-top: 15px; /* 文字垂直微調 */
    box-sizing: border-box; position: relative;
}
.stat-box span { font-size: 36px; color: #fff; font-weight: 800; font-family: monospace; text-shadow: 2px 2px 2px rgba(0,0,0,0.5); }
.score-effect { position: absolute; top: -20px; right: 20px; color: #ff5252; font-weight: bold; font-size: 24px; opacity: 0; }
@keyframes floatUp { 0% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-30px); } }

/* 下方技能按鈕區 */
.bottom-skills { display: flex; gap: 20px; margin-bottom: 20px; }
.skill-btn { 
    width: 85px; height: 85px; 
    background: rgba(0,0,0,0.2); border-radius: 12px; border: 2px solid #8D6E63;
    display: flex; flex-direction: column; justify-content: center; align-items: center;
    color: #fff;
}
.skill-btn img { width: 60px; height: 60px; object-fit: contain; }
.skill-cost { font-size: 12px; color: #ff8a80; font-weight: bold; margin-top: -5px; }

/* 3. 成就列表 (修復版) */
.modal-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: transparent; z-index: 2000; display: flex; justify-content: center; align-items: center; }
.modal-overlay.hidden { display: none; }
.overlay-dimmer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: -1; }
.popup-container { position: relative; display: flex; justify-content: center; align-items: center; }
.popup-bg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; }
.close-btn { position: absolute; top: 15px; right: 15px; width: 50px; height: 50px; }

.achievement-list { 
    width: 600px; height: 430px; 
    margin-top: 85px; margin-left: auto; margin-right: auto; 
    overflow-y: auto; padding-right: 10px; 
}
.achievement-list::-webkit-scrollbar { width: 8px; }
.achievement-list::-webkit-scrollbar-thumb { background: #4FC3F7; border-radius: 4px; }

.ach-item {
    width: 566px; height: 92px; margin: 0 auto 10px auto; position: relative;
    background-image: url('images/02_achievement/ach_bg.png'); background-size: 100% 100%;
    display: grid; 
    /* 恢復你喜歡的 Grid */
    grid-template-columns: 90px 150px 200px 1fr; 
    align-items: center;
}
.ach-col-icon { display: flex; justify-content: center; align-items: center; padding-left: 10px; }
.ach-col-icon img { width: 70px; height: 70px; object-fit: contain; }
.ach-col-title { font-size: 24px; font-weight: 900; color: #fff; padding-left: 20px; text-align: left; text-shadow: 0px 0px 2px rgba(0,0,0,0.5); }
.ach-col-desc { font-size: 14px; line-height: 1.4; color: #eceff1; text-align: left; padding-left: 80px; }
.ach-col-status { height: 100%; display: flex; justify-content: center; align-items: center; padding-right: 10px; }
.ach-col-status img { width: auto; height: 60%; object-fit: contain; }

/* 4. 演化圖鑑 (書本) */
.book-container { width: 890px; height: 570px; position: relative; display: flex; justify-content: center; align-items: center; }
.book-bg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; }
.page-left { position: absolute; top: 30px; left: 40px; width: 350px; height: 470px; }
.page-right { position: absolute; top: 30px; left: 440px; width: 350px; height: 470px; }
.book-grid-layout { display: grid; grid-template-columns: repeat(3, 1fr); grid-template-rows: repeat(3, 1fr); gap: 6px; height: 100%; align-content: start; }
.book-item { width: 100%; height: 100%; aspect-ratio: 97 / 128; position: relative; display: flex; flex-direction: column; align-items: center; justify-content: flex-start; }
.title-card img { width: 100%; height: auto; filter: contrast(1.2); }
.item-frame { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; }
.item-creature { position: relative; z-index: 1; width: 85%; height: 65%; object-fit: contain; margin-top: 8px; transition: transform 0.4s; }
.book-item:hover .item-creature { transform: translateY(-4px) scale(1); }
.item-info { position: absolute; z-index: 1; bottom: 1px; width: 100%; text-align: center; display: flex; justify-content: center; align-items: baseline; gap: 10px; }
.num-text { color: #bd8867; font-size: 30px; font-weight: 900; opacity: 0.5; }
.name-text { color: #795a50; font-size: 20px; font-weight: 900; }
.book-item.locked .item-creature, .book-item.locked .item-info { display: none; }

/* 5. 遊戲結束 */
.modal-content-small { width: 425px; height: 420px; position: relative; display: flex; flex-direction: column; justify-content: flex-end; align-items: center; padding-bottom: 40px; }
.modal-bg-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-size: contain; background-repeat: no-repeat; background-position: center; z-index: -1; }
.modal-btn-group { display: flex; gap: 30px; }
.popup-btn { width: 94px; height: 94px; }

@keyframes pop { 0% {transform: scale(0);} 80% {transform: scale(1.1);} 100% {transform: scale(1);} }
@keyframes float { 0%, 100% {transform: translateY(0);} 50% {transform: translateY(-8px);} }